import{_ as p,W as o,X as e,Y as s,Z as n,$ as t,a0 as l,C as c}from"./framework-c8ebc670.js";const i="/Starter/assets/code-prompt-e1e36eb4.jpg",r="/Starter/assets/myplugin-startup-item-3aecb29a.jpg",B="/Starter/assets/myplugin-gui-1734cf79.jpg",y={},A=l(`<p>从这里开始，你将了解如何创造一个简单的 <code>Starter</code> 插件应用。</p><h2 id="创建插件文件" tabindex="-1"><a class="header-anchor" href="#创建插件文件" aria-hidden="true">#</a> 创建插件文件</h2><p><code>Starter</code> 插件文件就是普通的 <code>AHK</code> 脚本文件，支持 <code>ahk</code>, <code>ah2</code> 两种文件后缀。</p><p><strong>插件目录：</strong> <code>Starter\\src\\Plugin</code></p><p>在插件目录内新建一个文件 <code>MyPlugin.ahk</code>，本文将以此插件为例子展开。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>插件目录在 <strong>Starter</strong> 目录下 <code>\\src\\Plugin</code></p></div><h2 id="插件信息" tabindex="-1"><a class="header-anchor" href="#插件信息" aria-hidden="true">#</a> 插件信息</h2><p><strong>Starter</strong> 通过解析目录内(不包括子目录)的 <code>AHK</code> 脚本文件是否含有插件信息来判断是否为插件文件。</p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">===Starter Plugin Info==&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">{</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    &quot;author&quot;: &quot;AkiChase&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    &quot;version&quot;: &quot;0.0.1&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    &quot;introduction&quot;: &quot;Starter Plugin example&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    &quot;icon&quot;: &quot;iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAgNJREFUWEft1UuozVEUx/HPHRmaMFBMTDwmYiJSQimUMqAoAwNRQoSSR3kVxfWIIjISojwGiiLKgBkTYSADZGAkE2VAS3vXdvr/z/2fc27nls6a/fde+7e+e62113/IGNvQGMc3APivMnALE1NPLWraW6OVgZl4k4Jew/p+A+zBiRR0LW72G+A5FuArpuFHPwHm4mUKeAUbmwYPvyY9sAlTsL9G+Eixtwr3kt9RfMKldkAjAZzFNhxrA/Aas/Axpf9XAbAP57C9DqIOIOp4AUvSwbjlwQqRqHvUP+w8thY+h3EgfT/BFrxv1agCiDRG8EnJ+TM240EFQM5QbC3Dw8JnBS5iclqLBg2Iu6VOK0DUOW6b7XZqqu81KfyAqXiLmAWtNh6XsbrYiKxEf/y1EuA64g1n24nTNYFjeSGepf2T2N3GdweGi/0bWNcrwFVsSKIxejNMFUcjgDjYSQm+YQJeYU7N7TsqQdZo0oTxOh6nA1HP3O0lR1dNmAVan+Fx7C3U48+XG2teMQlLgEPF0+3oGZYi+ZmdQdQx20+MwwvMr0l/ngNdDaJSM0bx9AJgKR4lh+iZmJJVFgBfeh3FVcJ3EH0SNhsxiru2kf4FVcK/0+JTLO46cjrYKcDyYiTvwql+A9zHyhR0Bt71GyDSHhZDaE2vweN8pyUYjZj/aAwABhn4A2ymYyH5RzvQAAAAAElFTkSuQmCC&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">&lt;==Starter Plugin Info===</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">*/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过解析 <code>===Starter Plugin Info==&gt;</code> 与 <code>&lt;==Starter Plugin Info===</code> 之间的 <code>JSON</code> 格式内容，插件将显示在<strong>插件界面</strong>中</p><ul><li>author</li></ul><p>插件作者</p><ul><li>version</li></ul><p>插件版本，未来可能作为插件更新检测的依据</p><ul><li>icon (可选)</li></ul><p>插件的图标，使用<strong>无头部</strong>的base64图片，尺寸最好是 <code>32 * 32</code>，格式建议 <code>png</code></p><h2 id="基本模板" tabindex="-1"><a class="header-anchor" href="#基本模板" aria-hidden="true">#</a> 基本模板</h2><p>为了规范的编写插件，在此提供一个插件基本模板。</p><p>在编写插件功能之前，你可以直接照搬这些内容。</p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">; MyPlugin.ahk</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">===Starter Plugin Info==&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">{</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    &quot;author&quot;: &quot;AkiChase&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    &quot;version&quot;: &quot;0.0.1&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    &quot;introduction&quot;: &quot;Starter Plugin example&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    &quot;icon&quot;: &quot;iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAgNJREFUWEft1UuozVEUx/HPHRmaMFBMTDwmYiJSQimUMqAoAwNRQoSSR3kVxfWIIjISojwGiiLKgBkTYSADZGAkE2VAS3vXdvr/z/2fc27nls6a/fde+7e+e62113/IGNvQGMc3APivMnALE1NPLWraW6OVgZl4k4Jew/p+A+zBiRR0LW72G+A5FuArpuFHPwHm4mUKeAUbmwYPvyY9sAlTsL9G+Eixtwr3kt9RfMKldkAjAZzFNhxrA/Aas/Axpf9XAbAP57C9DqIOIOp4AUvSwbjlwQqRqHvUP+w8thY+h3EgfT/BFrxv1agCiDRG8EnJ+TM240EFQM5QbC3Dw8JnBS5iclqLBg2Iu6VOK0DUOW6b7XZqqu81KfyAqXiLmAWtNh6XsbrYiKxEf/y1EuA64g1n24nTNYFjeSGepf2T2N3GdweGi/0bWNcrwFVsSKIxejNMFUcjgDjYSQm+YQJeYU7N7TsqQdZo0oTxOh6nA1HP3O0lR1dNmAVan+Fx7C3U48+XG2teMQlLgEPF0+3oGZYi+ZmdQdQx20+MwwvMr0l/ngNdDaJSM0bx9AJgKR4lh+iZmJJVFgBfeh3FVcJ3EH0SNhsxiru2kf4FVcK/0+JTLO46cjrYKcDyYiTvwql+A9zHyhR0Bt71GyDSHhZDaE2vweN8pyUYjZj/aAwABhn4A2ymYyH5RzvQAAAAAElFTkSuQmCC&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">&lt;==Starter Plugin Info===</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">*/</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">#Include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">..\\Utils\\PluginHelper.ah2</span><span style="color:#7F848E;font-style:italic;"> ; 引入插件工具模块</span></span>
<span class="line"><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addEntryFunc</span><span style="color:#ABB2BF;">((*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Plugin_MyPlugin</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">()) </span><span style="color:#7F848E;font-style:italic;">; 添加入口函数等待Starter执行</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">; 使用类，避免变量名、函数名污染</span></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Plugin_MyPlugin</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 入口函数，可以理解为插件的初始化函数</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">(){</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 在此处编写插件的主体内容</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="插件功能" tabindex="-1"><a class="header-anchor" href="#插件功能" aria-hidden="true">#</a> 插件功能</h2><h3 id="_1-添加插件专属菜单" tabindex="-1"><a class="header-anchor" href="#_1-添加插件专属菜单" aria-hidden="true">#</a> 1. 添加插件专属菜单</h3><p>最简单的功能莫过于将一个专属菜单添加到 <strong>Starter</strong>菜单中。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>此处的<strong>菜单</strong>指的是右键右下角托盘图标打开的菜单</p></div><p>这里就要介绍插件编写离不开的工具模块 <code>PluginHelper</code></p><p>在模板代码的最开始，我们就通过 <code>#Include ..\\Utils\\PluginHelper.ah2</code> 引入了这个模块</p>`,26),d={class:"hint-container tip"},F=s("p",{class:"hint-container-title"},"提示",-1),u=s("p",null,[s("code",null,"PluginHelper"),n(" 在 "),s("strong",null,"Starter"),n(" 中已经 "),s("code",null,"#include"),n(" 过。")],-1),v=s("strong",null,"获得代码提示",-1),E=s("strong",null,"vscode",-1),m={href:"https://marketplace.visualstudio.com/items?itemName=thqby.vscode-autohotkey2-lsp",target:"_blank",rel:"noopener noreferrer"},C=s("p",null,"可以获得非常详细的代码提示。",-1),b=s("p",null,[s("img",{src:i,alt:"代码提示",loading:"lazy"})],-1),g=l(`<p>为了<strong>代码结构清晰</strong>和<strong>避免变量污染</strong>，把一定规模的代码定义为一个新的函数并给出注释，将其放在<code>main</code>函数中执行。</p><p>养成良好的代码习惯，对看代码、写代码都有好处。</p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">class</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Plugin_MyPlugin</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 菜单初始化</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">menuInit</span><span style="color:#ABB2BF;">(){</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 首先创建一个菜单对象，也就是 \`MyPlugin\` 的专属菜单对象。</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">m</span><span style="color:#56B6C2;">:=</span><span style="color:#E5C07B;">Menu</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 然后为这个菜单简单添加几个功能</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">m</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;MsgBox&quot;</span><span style="color:#ABB2BF;">, (*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">MsgBox</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;使用msgbox弹窗&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 此处使用了另一个非常常用的Starter API: PluginHelper.Utils.tip()方法</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">m</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Tip&quot;</span><span style="color:#ABB2BF;">, (*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;提示&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;使用WiseGui弹窗&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1500</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 最后通过 PluginHelper.pluginMenu 属性，访问Starter为插件提供的菜单对象。</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 将专属菜单对象作为子菜单添加到 PluginHelper.pluginMenu 中</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginMenu</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;MyPlugin专属菜单&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">m</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 如果之后还需要访问到这个专属菜单对象，可以将其添加到this(指向Plugin_MyPlugin)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; this.menu:=m</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>如果没有类相关的知识，你可能会疑惑<code>static</code>前缀是什么。</p><p>在编写插件时，你只要记住 <code>static</code> 前缀的函数 <code>xxx</code> 才能直接通过类名<code>Plugin_MyPlugin.xxx</code> 访问</p><p>而<code>static</code> 前缀的函数体内一般 <code>this</code> 指向当前类，也就是 <code>Plugin_MyPlugin</code></p></div><p>最后，别忘了在 <code>static main(){}</code> 函数体中添加<code>this.menuInit()</code>，这样<code>main</code>入口函数被 <strong>Starter</strong> 执行时，你的<code>menuInit</code>函数才会被执行。</p><p><strong>本次给出完整代码，之后的内容仅仅给出功能相关的代码。</strong></p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">#Include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">..\\Utils\\PluginHelper.ah2</span><span style="color:#7F848E;font-style:italic;"> ; 引入插件工具模块</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addEntryFunc</span><span style="color:#ABB2BF;">((*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Plugin_MyPlugin</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">()) </span><span style="color:#7F848E;font-style:italic;">; 添加入口函数等待Starter执行</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">; 使用类，避免变量名、函数名污染</span></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Plugin_MyPlugin</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 入口函数，可以理解为插件的初始化函数</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">(){</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">menuInit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 菜单初始化</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">menuInit</span><span style="color:#ABB2BF;">(){</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">m</span><span style="color:#56B6C2;">:=</span><span style="color:#E5C07B;">Menu</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">m</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;MsgBox&quot;</span><span style="color:#ABB2BF;">, (*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">MsgBox</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;使用msgbox弹窗&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">m</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Tip&quot;</span><span style="color:#ABB2BF;">, (*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;提示&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;使用WiseGui弹窗&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1500</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginMenu</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;MyPlugin专属菜单&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">m</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重启 <strong>Starter</strong> 后，就可以通过 <strong>Starter菜单</strong> &gt; <strong>插件功能</strong> &gt; <strong>MyPlugin专属菜单</strong> 进行访问。</p><h3 id="add-plugin-to-startup-mode" tabindex="-1"><a class="header-anchor" href="#add-plugin-to-startup-mode" aria-hidden="true">#</a> 2. 添加插件启动项</h3><p><strong>插件启动项</strong>的功能类似于<strong>原生启动项</strong>，但是只能通过插件来添加、修改。</p><p>添加<strong>插件启动项</strong>需要使用 <code>PluginHelper.addPluginToStartupMode()</code> API</p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">* </span><span style="color:#C678DD;font-style:italic;">@description</span><span style="color:#7F848E;font-style:italic;">: 添加插件项到启动模式列表</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">* </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#7F848E;font-style:italic;"> </span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#7F848E;font-style:italic;"> 插件id, 即文件名</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">* </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#7F848E;font-style:italic;"> </span><span style="color:#E06C75;font-style:italic;">title</span><span style="color:#7F848E;font-style:italic;"> 插件项显示标题</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">* </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#7F848E;font-style:italic;"> </span><span style="color:#E06C75;font-style:italic;">keywords</span><span style="color:#7F848E;font-style:italic;"> 插件项关键字</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">* </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#7F848E;font-style:italic;"> </span><span style="color:#E06C75;font-style:italic;">startHandler</span><span style="color:#7F848E;font-style:italic;"> 鼠标双击、回车该插件项时执行的函数 (obj, searchText)=&gt;any obj指向添加的插件项对象</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">* </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#7F848E;font-style:italic;"> </span><span style="color:#E06C75;font-style:italic;">doubleRightHandler</span><span style="color:#7F848E;font-style:italic;"> 选填, 双击Right该插件项时执行的函数 (obj, searchText)=&gt;any obj指向添加的插件项对象</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">* </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#7F848E;font-style:italic;"> </span><span style="color:#E06C75;font-style:italic;">contextHandler</span><span style="color:#7F848E;font-style:italic;"> 选填, 右键该插件项时的处理函数 (obj)=&gt;any obj指向添加的插件项对象</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">* </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#7F848E;font-style:italic;"> </span><span style="color:#E06C75;font-style:italic;">hIcon</span><span style="color:#7F848E;font-style:italic;"> 选填, 插件项显示的图标HICON, 默认使用插件的图标</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">*/</span></span>
<span class="line"><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">addPluginToStartupMode</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">keywords</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">startHandler</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">doubleRightHandler</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">contextHandler</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">hIcon</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>直接上代码，根据代码和注释了解具体用法。</p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">class</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Plugin_MyPlugin</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 获取插件id即文件名</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#56B6C2;">SplitPath</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">A_LineFile</span><span style="color:#ABB2BF;">, &amp;</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 保存到类变量，便于其他类方法访问</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">name</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addStartupItem</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 添加插件启动项</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">addStartupItem</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 鼠标双击、回车当前项的处理函数</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#61AFEF;">startHandler</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 使用WiseGui通知 通知标题使用了this.name即文件名，也可以使用obj.title即插件启动项标题</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;搜索框内容:&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 隐藏搜索框</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">hideSearchGui</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 可以添加多个插件项，但每个插件的插件项应当具有相同的name，不同的title避免混淆</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addPluginToStartupMode</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">; 使用main方法中保存的插件id</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;插件示例&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            [</span><span style="color:#98C379;">&quot;plugin demo&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;CJSL&quot;</span><span style="color:#ABB2BF;">], </span><span style="color:#7F848E;font-style:italic;">; 该启动项的其他关键字</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">startHandler</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">; 使用显式定义的函数</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 使用匿名函数作为双击Right的处理函数</span></span>
<span class="line"><span style="color:#ABB2BF;">            (</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">obj</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;双击Right&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">),,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 定义该插件项显示的图标HICON，此处用base64ToHICON方法将base64图片载入得到HICON</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">base64ToHICON</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAnBJREFUWEfVlj9oFEEUxt+bLa6wF0whQcRCENOo2EUQYy/xZmb3sDKCoK0RhURQSFoFwdhcuNuZPY+AXKU22gmKiI2FAREbwUrwrI6dJxN2wv3Z21vZDWe2291vv/fbNx9vBmHKF065Pvy/AEKI60R0EhGPFekSEX1BxE9a68dpPqkdEEI0AcAvUjjl21BrHQw/HwGoVqsXGGMvE+E3ItosAoKIVwBg1noYYxZardarfr8RACHEDQB4aEWe5800m80fRQCCIDgax/F24nFTa/0oE4BzvoqIK1aktS4lpEIIsn5EdC+KotX9CyClXDLGzGQtCWNs2/O8541G44/TldIBKeUcEX3MkwfG2OkwDN+XCsA5n0XECADOTID4UKlUztfr9V+lAuT583GaUpZg6gC1Wu1Ar9dbdENlHJANYbfb7XQ6nd+lLoHv+6eMMe/ydIKIzkVR9KZUgCAIDsVxfBsATmRB2M0niqJr/Zr9mwHbymRP+BmG4ec87Xca3/ePx3F80N4j4uuJo1hKeYSI1gDABm3kQsR1pdRyHggp5RoR3RqjbSPislLq6w6cE3HOnyDi0oQCT7XWmRohxAYAXJ2Qkw2Xk12A/qAAwG6Ckxbav7mYmA68Syk0nzx7QUTrQ+/nh3faVIDhLdOaCCHuA8CdPEsAAA+01neHtWlbfW4AayalXDDGnM2CYIy9VUq5E9WAtDBAzr8fK+OcryDizoHEHXb+qQMlAIyctnKFsGjhvu8zQ/hs3AwoEcBZtbXWlwfmgJRykYiqAHBpDwr2W24hYksp1R4AcAo7EY0xh/cCgjH23U1A51/KsbsI7NQB/gIoe4UwRdVGRAAAAABJRU5ErkJggg==&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 也可以通过 PluginHelper.getPluginHIcon(this.name) 获取插件信息中的设定的图标HICON</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重启 <strong>Starter</strong> 后，呼出搜索框就可以在列表中看到当前插件启动项</p><p><img src="`+r+`" alt="插件启动项" loading="lazy"></p><p>回车或者鼠标双击，还有双击Right可以看到 <code>WishGui</code> 通知。</p><h3 id="_3-添加自定义gui" tabindex="-1"><a class="header-anchor" href="#_3-添加自定义gui" aria-hidden="true">#</a> 3. 添加自定义GUI</h3><p>添加自定义GUI十分自由，可以不依赖 <strong>Starter</strong> 提供的API。</p><p>但是可以通过调用API使用一些 <strong>Starter</strong> 提供的功能、资源。</p><p>原则上只有Starter提供的插件模式无法满足需求时，才使用自定义GUI。</p><p>还是上代码，看注释。</p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">class</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Plugin_MyPlugin</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#56B6C2;">SplitPath</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">A_LineFile</span><span style="color:#ABB2BF;">, &amp;</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">name</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">menuInit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">guiInit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">menuInit</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">m</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Menu</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 添加到菜单中，从而通过点击菜单显示gui</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">m</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;GUI&quot;</span><span style="color:#ABB2BF;">, (*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">gui</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Show</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginMenu</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;MyPlugin专属菜单&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">m</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">guiInit</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">g</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Gui</span><span style="color:#ABB2BF;">(, </span><span style="color:#98C379;">&quot;MyPlugin自定义GUI&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">BackColor</span><span style="color:#56B6C2;">:=</span><span style="color:#98C379;">&quot;FFFFFF&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">SetFont</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;s14 q5&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;NSimSun&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">SetFont</span><span style="color:#ABB2BF;">(, </span><span style="color:#98C379;">&quot;雅痞-简&quot;</span><span style="color:#ABB2BF;">)    </span><span style="color:#7F848E;font-style:italic;">;优先使用更好看的字体</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">AddText</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;通过API获取插件图标作为图片显示&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 使用hIcon作为图片来源</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 注意hIcon:*务必加上*来使用图片副本</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 避免图片资源被用后销毁</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">AddPicture</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;w100 h100&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;hIcon:*&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getPluginHIcon</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">AddEdit</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;w100&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 为编辑框加上change事件回调来通知变化</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">e</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">OnEvent</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Change&quot;</span><span style="color:#ABB2BF;">, (</span><span style="color:#E06C75;">ctrl</span><span style="color:#ABB2BF;">, *) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;当前编辑文本:</span><span style="color:#56B6C2;">\`n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">ctrl</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Value</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 隐藏窗口暂不显示</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Show</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Hide&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 添加到类变量方便其他函数访问</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 比如在菜单中添加一项来显示gui</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">gui</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">g</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以在 <code>MyPlugin专属菜单</code> 中点击 <code>GUI</code> 来显示这个自定义GUI</p><p><img src="`+B+`" alt="自定义GUI" loading="lazy"></p><h2 id="最后" tabindex="-1"><a class="header-anchor" href="#最后" aria-hidden="true">#</a> 最后</h2><p>根据之前的内容，你应该对插件开发有了基本的了解，当然这只是插件API运用的最简单的一部分。</p><p>阅读开发文档的其他内容后，比如强大的<strong>插件智能项</strong>，<strong>ImagePut</strong> 等等，你可以试着开发一款属于你自己的 <strong>Starter</strong> 插件应用。</p><p>以下是 <code>MyPlugin.ahk</code> 的完整内容，作为快速上手的参考：</p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">; MyPlugin.ahk</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">===Starter Plugin Info==&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">{</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    &quot;author&quot;: &quot;AkiChase&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    &quot;version&quot;: &quot;0.0.1&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    &quot;introduction&quot;: &quot;Starter Plugin example&quot;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    &quot;icon&quot;: &quot;iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAgNJREFUWEft1UuozVEUx/HPHRmaMFBMTDwmYiJSQimUMqAoAwNRQoSSR3kVxfWIIjISojwGiiLKgBkTYSADZGAkE2VAS3vXdvr/z/2fc27nls6a/fde+7e+e62113/IGNvQGMc3APivMnALE1NPLWraW6OVgZl4k4Jew/p+A+zBiRR0LW72G+A5FuArpuFHPwHm4mUKeAUbmwYPvyY9sAlTsL9G+Eixtwr3kt9RfMKldkAjAZzFNhxrA/Aas/Axpf9XAbAP57C9DqIOIOp4AUvSwbjlwQqRqHvUP+w8thY+h3EgfT/BFrxv1agCiDRG8EnJ+TM240EFQM5QbC3Dw8JnBS5iclqLBg2Iu6VOK0DUOW6b7XZqqu81KfyAqXiLmAWtNh6XsbrYiKxEf/y1EuA64g1n24nTNYFjeSGepf2T2N3GdweGi/0bWNcrwFVsSKIxejNMFUcjgDjYSQm+YQJeYU7N7TsqQdZo0oTxOh6nA1HP3O0lR1dNmAVan+Fx7C3U48+XG2teMQlLgEPF0+3oGZYi+ZmdQdQx20+MwwvMr0l/ngNdDaJSM0bx9AJgKR4lh+iZmJJVFgBfeh3FVcJ3EH0SNhsxiru2kf4FVcK/0+JTLO46cjrYKcDyYiTvwql+A9zHyhR0Bt71GyDSHhZDaE2vweN8pyUYjZj/aAwABhn4A2ymYyH5RzvQAAAAAElFTkSuQmCC&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">&lt;==Starter Plugin Info===</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">*/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">#Include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">..\\Utils\\PluginHelper.ah2</span></span>
<span class="line"><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addEntryFunc</span><span style="color:#ABB2BF;">((*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Plugin_MyPlugin</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">()) </span><span style="color:#7F848E;font-style:italic;">; 添加入口函数等待Starter执行</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">; 使用类，避免变量名、函数名污染</span></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Plugin_MyPlugin</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 入口函数，可以理解为插件的初始化函数</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 在此处编写插件的主体内容</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 获取插件id即文件名</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#56B6C2;">SplitPath</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">A_LineFile</span><span style="color:#ABB2BF;">, &amp;</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 保存到类变量，便于其他类方法访问</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">name</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 为了结构清晰，下面将每一步都定义为一个函数然后执行</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 添加插件启动项</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">menuInit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 添加插件启动项</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addStartupItem</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">guiInit</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">guiInit</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">g</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Gui</span><span style="color:#ABB2BF;">(, </span><span style="color:#98C379;">&quot;MyPlugin自定义GUI&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">BackColor</span><span style="color:#56B6C2;">:=</span><span style="color:#98C379;">&quot;FFFFFF&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">SetFont</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;s14 q5&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;NSimSun&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">SetFont</span><span style="color:#ABB2BF;">(, </span><span style="color:#98C379;">&quot;雅痞-简&quot;</span><span style="color:#ABB2BF;">)    </span><span style="color:#7F848E;font-style:italic;">;优先使用更好看的字体</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">AddText</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;通过API获取插件图标作为图片显示&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 使用hIcon作为图片来源</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 注意hIcon:*务必加上*来使用图片副本</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 避免图片资源被用后销毁</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">AddPicture</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;w100 h100&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;hIcon:*&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getPluginHIcon</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">AddEdit</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;w100&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 为编辑框加上change事件回调来通知变化</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">e</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">OnEvent</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Change&quot;</span><span style="color:#ABB2BF;">, (</span><span style="color:#E06C75;">ctrl</span><span style="color:#ABB2BF;">, *) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;当前编辑文本:</span><span style="color:#56B6C2;">\`n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">ctrl</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Value</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 隐藏窗口暂不显示</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Show</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Hide&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 添加到类变量方便其他函数访问</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 比如在菜单中添加一项来显示gui</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">gui</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">g</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 菜单初始化</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">menuInit</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 首先创建一个菜单对象，也就是 \`MyPlugin\` 的专属菜单对象。</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">m</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Menu</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 然后为这个菜单简单添加几个功能</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">m</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;MsgBox&quot;</span><span style="color:#ABB2BF;">, (*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">MsgBox</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;使用msgbox弹窗&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 此处使用了另一个非常常用的Starter API: PluginHelper.Utils.tip()方法</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">m</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Tip&quot;</span><span style="color:#ABB2BF;">, (*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;提示&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;使用WiseGui弹窗&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1500</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">m</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;GUI&quot;</span><span style="color:#ABB2BF;">, (*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">gui</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Show</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 最后通过 PluginHelper.pluginMenu 属性，访问Starter为插件提供的菜单对象。</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 将专属菜单对象作为子菜单添加到 PluginHelper.pluginMenu 中</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginMenu</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;MyPlugin专属菜单&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">m</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 如果之后还需要访问到这个专属菜单对象，可以将其添加到this(指向Plugin_MyPlugin)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; this.menu:=m</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 添加插件启动项</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">addStartupItem</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 鼠标双击、回车当前项的处理函数</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#61AFEF;">startHandler</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 使用WiseGui通知 通知标题使用了this.name即文件名，也可以使用obj.title即插件启动项标题</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;搜索框内容:&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 隐藏搜索框</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">hideSearchGui</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 可以添加多个插件项，但每个插件的插件项应当具有相同的name，不同的title避免混淆</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addPluginToStartupMode</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">; 使用main方法中保存的插件id</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;插件示例&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            [</span><span style="color:#98C379;">&quot;plugin demo&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;CJSL&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">startHandler</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">; 使用显式定义的函数</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 使用匿名函数作为双击Right的处理函数</span></span>
<span class="line"><span style="color:#ABB2BF;">            (</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">obj</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;双击Right&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">), ,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 定义该插件项显示的图标HICON，此处用base64ToHICON方法将base64图片载入得到HICON</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">base64ToHICON</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAnBJREFUWEfVlj9oFEEUxt+bLa6wF0whQcRCENOo2EUQYy/xZmb3sDKCoK0RhURQSFoFwdhcuNuZPY+AXKU22gmKiI2FAREbwUrwrI6dJxN2wv3Z21vZDWe2291vv/fbNx9vBmHKF065Pvy/AEKI60R0EhGPFekSEX1BxE9a68dpPqkdEEI0AcAvUjjl21BrHQw/HwGoVqsXGGMvE+E3ItosAoKIVwBg1noYYxZardarfr8RACHEDQB4aEWe5800m80fRQCCIDgax/F24nFTa/0oE4BzvoqIK1aktS4lpEIIsn5EdC+KotX9CyClXDLGzGQtCWNs2/O8541G44/TldIBKeUcEX3MkwfG2OkwDN+XCsA5n0XECADOTID4UKlUztfr9V+lAuT583GaUpZg6gC1Wu1Ar9dbdENlHJANYbfb7XQ6nd+lLoHv+6eMMe/ydIKIzkVR9KZUgCAIDsVxfBsATmRB2M0niqJr/Zr9mwHbymRP+BmG4ec87Xca3/ePx3F80N4j4uuJo1hKeYSI1gDABm3kQsR1pdRyHggp5RoR3RqjbSPislLq6w6cE3HOnyDi0oQCT7XWmRohxAYAXJ2Qkw2Xk12A/qAAwG6Ckxbav7mYmA68Syk0nzx7QUTrQ+/nh3faVIDhLdOaCCHuA8CdPEsAAA+01neHtWlbfW4AayalXDDGnM2CYIy9VUq5E9WAtDBAzr8fK+OcryDizoHEHXb+qQMlAIyctnKFsGjhvu8zQ/hs3AwoEcBZtbXWlwfmgJRykYiqAHBpDwr2W24hYksp1R4AcAo7EY0xh/cCgjH23U1A51/KsbsI7NQB/gIoe4UwRdVGRAAAAABJRU5ErkJggg==&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 也可以通过 PluginHelper.getPluginHIcon(this.name) 获取插件信息中的设定的图标HICON</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,30);function h(f,q){const a=c("ExternalLinkIcon");return o(),e("div",null,[A,s("div",d,[F,u,s("p",null,[n("所以在此重复引用这个模块的目的仅仅是为了"),v,n("，使用"),E,n("配合"),s("a",m,[n("ahk2扩展"),t(a)]),n("，")]),C,b]),g])}const P=p(y,[["render",h],["__file","get-started.html.vue"]]);export{P as default};
