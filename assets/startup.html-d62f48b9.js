import{_ as e,W as B,X as t,Y as n,Z as s,$ as l,a1 as p,a0 as o,C as c}from"./framework-c8ebc670.js";const r="/Starter/assets/startup-1-b89ca9e5.jpg",i="/Starter/assets/startup-2-a18cdcb5.jpg",y="/Starter/assets/startup-3-6b8340e0.jpg",d="/Starter/assets/startup-4-cd155790.jpg",F="/Starter/assets/startup-5-a663484b.jpg",A={},u=o('<p>插件启动项类似于原生启动项，但是更加<strong>自由</strong>、<strong>强大</strong>。</p><h2 id="api" tabindex="-1"><a class="header-anchor" href="#api" aria-hidden="true">#</a> API</h2><p>添加<strong>插件启动项</strong>需要使用 <code>PluginHelper.addPluginToStartupMode()</code> API</p>',3),v=n("h2",{id:"简单应用",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#简单应用","aria-hidden":"true"},"#"),s(" 简单应用")],-1),m=o(`<h2 id="进阶应用" tabindex="-1"><a class="header-anchor" href="#进阶应用" aria-hidden="true">#</a> 进阶应用</h2><p>主要通过ahk<strong>闭包特性</strong>进行更多操作，和 <code>js</code> 中的闭包一样，用起来非常灵活。</p><h3 id="_1-同时添加多个插件项" tabindex="-1"><a class="header-anchor" href="#_1-同时添加多个插件项" aria-hidden="true">#</a> 1. 同时添加多个插件项</h3><p>批量添加多个插件项，通过 <code>obj</code> 对象的属性、ahk<strong>闭包特性</strong>执行预期的内容。</p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">; 添加插件启动项</span></span>
<span class="line"><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">addStartupItem</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">demoData</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Map</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;明月几时有&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;把酒问青天&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;不知天上宫阙&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;今夕是何年&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;我欲乘风归去&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;又恐琼楼玉宇&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 利用闭包特性，可以访问到demoData</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">startHandler</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">demoData</span><span style="color:#ABB2BF;">[</span><span style="color:#E5C07B;">obj</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">v</span><span style="color:#ABB2BF;"> in </span><span style="color:#E06C75;">demoData</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 如果startHandler闭包在此处，甚至可以直接访问到k,v</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addPluginToStartupMode</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 使用工具函数将其转换为拼音首字母作为关键词</span></span>
<span class="line"><span style="color:#ABB2BF;">            [</span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">chineseFirstChar</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">)],</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">startHandler</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>批量添加结果</p><p><img src="`+r+'" alt="批量添加启动项" loading="lazy"></p><p>搜索拼音首字母 <code>wy</code> 得到唯一匹配启动项</p><p><img src="'+i+'" alt="搜索" loading="lazy"></p><p>启动结果如下图</p><p><img src="'+y+`" alt="执行" loading="lazy"></p><h3 id="_2-右键菜单" tabindex="-1"><a class="header-anchor" href="#_2-右键菜单" aria-hidden="true">#</a> 2. 右键菜单</h3><p>右键当前项时可以通过 <code>contextHandler</code> 显示菜单，而通过<strong>闭包</strong>或者为函数<em>bind参数</em>可以区分出具体是哪一项</p><ul><li>纯闭包实现</li></ul><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">; 添加插件启动项</span></span>
<span class="line"><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">addStartupItem</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">demoData</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Map</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;明月几时有&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;把酒问青天&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;不知天上宫阙&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;今夕是何年&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;我欲乘风归去&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;又恐琼楼玉宇&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 利用闭包</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">curContextObj</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">m</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Menu</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">m</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;显示后半句&quot;</span><span style="color:#ABB2BF;">, (*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">demoData</span><span style="color:#ABB2BF;">[</span><span style="color:#E5C07B;">curContextObj</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">]))</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">contextHandler</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">){</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 利用闭包，在显示菜单时将 curContextObj 赋值，从而能在外访问到符合预期的后半句</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">curContextObj</span><span style="color:#56B6C2;">:=</span><span style="color:#E06C75;">obj</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">m</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Show</span><span style="color:#ABB2BF;">() </span><span style="color:#7F848E;font-style:italic;">; 显示菜单</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">v</span><span style="color:#ABB2BF;"> in </span><span style="color:#E06C75;">demoData</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addPluginToStartupMode</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            [</span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">chineseFirstChar</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">)],</span></span>
<span class="line"><span style="color:#ABB2BF;">            (*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">contextHandler</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>闭包 + Bind 实现</li></ul><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">addStartupItem</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">demoData</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Map</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;明月几时有&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;把酒问青天&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;不知天上宫阙&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;今夕是何年&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;我欲乘风归去&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;又恐琼楼玉宇&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 利用闭包</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">words</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">m</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Menu</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">m</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;显示后半句&quot;</span><span style="color:#ABB2BF;">, (*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">words</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">contextHandler</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">bindParam</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 利用闭包，在显示菜单时将 words 赋值，从而能在外访问到符合预期的后半句</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">words</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">bindParam</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">m</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Show</span><span style="color:#ABB2BF;">() </span><span style="color:#7F848E;font-style:italic;">; 显示菜单</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">v</span><span style="color:#ABB2BF;"> in </span><span style="color:#E06C75;">demoData</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addPluginToStartupMode</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            [</span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">chineseFirstChar</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">)],</span></span>
<span class="line"><span style="color:#ABB2BF;">            (*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, ,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">contextHandler</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Bind</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">v</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>效果相同，只是思路上有细微的区别。</p><p><img src="`+d+'" alt="执行" loading="lazy"></p><p><img src="'+F+'" alt="执行" loading="lazy"></p>',20);function C(b,E){const a=c("RouterLink");return B(),t("div",null,[u,n("p",null,[s("参数及说明："),l(a,{to:"/api/addPluginToStartupMode.html"},{default:p(()=>[s("PluginHelper.addPluginToStartupMode")]),_:1})]),v,n("p",null,[s("在启动该插件项时触发某个功能，参考"),l(a,{to:"/dev/get-started.html#add-plugin-to-startup-mode"},{default:p(()=>[s("快速上手 - 添加插件启动项")]),_:1})]),m])}const g=e(A,[["render",C],["__file","startup.html.vue"]]);export{g as default};
