import{_ as B,W as c,X as r,Y as n,Z as s,$ as l,a1 as o,a0 as a,C as e}from"./framework-c8ebc670.js";const i="/Starter/assets/plugin-mode-1-0e6c16b3.jpg",y="/Starter/assets/plugin-mode-2-68306e23.jpg",F="/Starter/assets/plugin-mode-3-e7e21c48.jpg",d="/Starter/assets/plugin-mode-4-30884393.jpg",A="/Starter/assets/plugin-mode-5-0619d73a.jpg",u="/Starter/assets/plugin-mode-6-87fc45e5.jpg",v="/Starter/assets/plugin-mode-7-e094589d.jpg",E="/Starter/assets/plugin-mode-8-278cd0ef.jpg",C="/Starter/assets/plugin-mode-9-0a71080b.jpg",m={},h=a('<p><strong>插件模式</strong>类似于启动模式、智能模式，但更加自由、强大，<strong>Starter</strong> 仅仅提供一个搜索框，其他内容全部由插件定义。</p><p>可以定义的内容包括：</p><ol><li>待搜索数据</li><li>搜索处理函数</li><li>运行处理函数</li><li>（可选）双击Right处理函数</li><li>（可选）加载图标处理函数</li><li>（可选）触底处理函数</li><li>（可选）粘贴内容处理函数</li><li>（可选）拖入文件处理函数</li><li>（可选）初始化函数</li><li>（可选）初始搜索框文本</li><li>（可选）搜索框占位符</li><li>（可选）搜索框图标</li></ol><h2 id="api" tabindex="-1"><a class="header-anchor" href="#api" aria-hidden="true">#</a> API</h2><p>进入<strong>插件模式</strong>需要使用 <code>PluginHelper.showPluginMode()</code> API</p>',5),b=a("<p>除此之外还需要了解一下 <code>PluginMode</code> 模块的几个成员。</p><p><code>PluginMode</code> 是使用插件模式时处理函数中 <code>that</code> 参数指向的类，我们一般只需要了解下面几个数据存储位置即可。</p><ul><li><code>that.pluginSearchData</code></li></ul><p><code>showPluginMode()</code>函数中第一个参数传递的数据会被储存在当前位置，意义是<strong>可能</strong>出现在插件模式<strong>搜索结果</strong>的全部静态内容</p>",4),g=n("strong",null,"静态内容",-1),D=a('<ul><li><code>that.pluginSearchResult</code></li></ul><p>插件应当在 <code>searchHandler</code> 即搜索处理函数中，将要显示的搜索结果储存在当前位置，方便 <code>runHandler</code> 访问。</p><ul><li><code>that.pluginOtherData</code></li></ul><p>插件如果有额外的数据，可以存放到当前位置</p><div class="hint-container danger"><p class="hint-container-title">警告</p><p>插件应用在使用<strong>插件模式</strong>时禁止将任何数据存储在 <code>PluginMode</code>或者说 <code>that</code> 的其他位置。</p><p>若数据较多，请嵌套至对象后存储。</p></div><ul><li><code>that.listView</code></li></ul>',6),f={href:"https://orz707.gitee.io/v2/docs/commands/ListView.htm",target:"_blank",rel:"noopener noreferrer"},_=a(`<ul><li><code>that.resizeGui()</code></li></ul><p>重新计算并调整列表、窗口大小，一般在修改<code>listView</code>的内容之后调用</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p><code>resizeGui()</code> 方法中会调用 <code>that.listView.Opt(&quot;Redraw&quot;)</code>，所以无需再启用重绘</p></div><h2 id="最简示例" tabindex="-1"><a class="header-anchor" href="#最简示例" aria-hidden="true">#</a> 最简示例</h2><p>最简示例直接上<strong>相关部分</strong>代码，看注释</p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">class</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Plugin_MyPlugin</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#56B6C2;">SplitPath</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">A_LineFile</span><span style="color:#ABB2BF;">, &amp;</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">name</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 添加 进入插件模式 菜单项</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">m</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Menu</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">m</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;进入插件模式&quot;</span><span style="color:#ABB2BF;">, (*) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">showPluginMode</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginMenu</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">m</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 进入插件模式</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">showPluginMode</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 临时数据</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">tmpData</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">            [</span><span style="color:#98C379;">&quot;明月几时有&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;把酒问青天&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">            [</span><span style="color:#98C379;">&quot;不知天上宫阙&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;今夕是何年&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">            [</span><span style="color:#98C379;">&quot;我欲乘风归去&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;又恐琼楼玉宇&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        ]</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 构造出我们真正需要的数据，方便在searchHandler中使用</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">searchData</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;"> in </span><span style="color:#E06C75;">tmpData</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">searchData</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Push</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">title</span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">keywords</span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">chineseFirstChar</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]), </span><span style="color:#7F848E;font-style:italic;">; 拼音首字母作为关键词</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">answer</span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            })</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 释放不必要的占用，虽然不多，但要有这个意识</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">tmpData</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 此处that指的是 pluginMode 模块，即插件模式</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#61AFEF;">searchHandler</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">that</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 如果有搜索内容则进行匹配</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">StrLen</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchResult</span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;">[] </span><span style="color:#7F848E;font-style:italic;">; 重置 pluginSearchResult</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;"> in </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchData</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#7F848E;font-style:italic;">; 如果搜索内容是title或者keywords的一部分则添加到搜索结果</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">InStr</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">InStr</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">keywords</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchResult</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                }</span></span>
<span class="line"><span style="color:#ABB2BF;">            } </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">; 否则显示全部</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchResult</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchData</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 对搜索结果进行渲染，即添加到listview中</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">;重置列表</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">listView</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Opt</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;-Redraw&quot;</span><span style="color:#ABB2BF;">)    </span><span style="color:#7F848E;font-style:italic;">;禁用重绘</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">listView</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Delete</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;"> in </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchResult</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#7F848E;font-style:italic;">; 这里使用title作为内容</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">listView</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(, </span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 调整gui尺寸 并启用重绘，该函数包含了Opt(&quot;Redraw&quot;)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resizeGui</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#61AFEF;">runHandler</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">that</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">rowNum</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 通过pluginSearchResult和当前启动的行号访问到当前数据</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">curData</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchResult</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">rowNum</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 显示当前项的诗词后半句</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 此处的this指的是当前插件，不要和that混淆</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">curData</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">answer</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">showPluginMode</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">searchData</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">searchHandler</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">runHandler</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>效果如图：</p><p><img src="`+i+'" alt="最简示例:无搜索内容" loading="lazy"></p><p><img src="'+y+'" alt="最简示例:有搜索内容" loading="lazy"></p><p><img src="'+F+`" alt="最简示例:执行结果" loading="lazy"></p><h2 id="从启动项进入" tabindex="-1"><a class="header-anchor" href="#从启动项进入" aria-hidden="true">#</a> 从启动项进入</h2><p>虽然可以像最简示例中一样，通过菜单而进入<strong>插件模式</strong>。</p><p>但是最常用的方式还是通过<strong>插件启动项</strong>的运行处理函数进入。</p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">; 添加 进入MyPlugin插件模式 启动项</span></span>
<span class="line"><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addPluginToStartupMode</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&quot;进入MyPlugin插件模式&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    [</span><span style="color:#98C379;">&quot;进入MyPlugin插件模式&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">chineseFirstChar</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;进入MyPlugin插件模式&quot;</span><span style="color:#ABB2BF;">)],</span></span>
<span class="line"><span style="color:#ABB2BF;">    (</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">showPluginMode</span><span style="color:#ABB2BF;">(), </span><span style="color:#7F848E;font-style:italic;">; 运行则进入插件模式</span></span>
<span class="line"><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+d+`" alt="从启动项进入" loading="lazy"></p><h2 id="简易文件夹示例" tabindex="-1"><a class="header-anchor" href="#简易文件夹示例" aria-hidden="true">#</a> 简易文件夹示例</h2><p>这个示例中，可以通过<strong>启动项</strong>进入<strong>插件模式</strong>，显示软件图片资源文件夹内的所有文件。</p><p>可以通过文件名或者拼音首字母转换后的文件名进行<strong>搜索筛选</strong>，运行则<strong>在文件夹中打开</strong>指定项</p><p>具体如何上代码，看注释</p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">class</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Plugin_MyPlugin</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#56B6C2;">SplitPath</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">A_LineFile</span><span style="color:#ABB2BF;">, &amp;</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">name</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 添加 进入MyPlugin插件模式 启动项</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addPluginToStartupMode</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;简易文件夹&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            [</span><span style="color:#98C379;">&quot;简易文件夹&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">chineseFirstChar</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;简易文件夹&quot;</span><span style="color:#ABB2BF;">)],</span></span>
<span class="line"><span style="color:#ABB2BF;">            (</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">showPluginMode</span><span style="color:#ABB2BF;">(), </span><span style="color:#7F848E;font-style:italic;">; 启动则进入插件模式</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 进入插件模式</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">showPluginMode</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 构造文件夹相关数据</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">searchData</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; PluginHelper.imgDir 为Starter存放图片资源的目录</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">loop files</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">imgDir</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;\\*.*&quot;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">searchData</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Push</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">title</span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">A_LoopFileName</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">keywords</span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">chineseFirstChar</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">A_LoopFileName</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">path</span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">A_LoopFileFullPath</span></span>
<span class="line"><span style="color:#ABB2BF;">            })</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 此处that指的是 pluginMode 模块，即插件模式</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#61AFEF;">searchHandler</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">that</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 如果有搜索内容则进行匹配</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">StrLen</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchResult</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> [] </span><span style="color:#7F848E;font-style:italic;">; 重置 pluginSearchResult</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;"> in </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchData</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#7F848E;font-style:italic;">; 如果搜索内容是title或者keywords的一部分则添加到搜索结果</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">InStr</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">InStr</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">keywords</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchResult</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                }</span></span>
<span class="line"><span style="color:#ABB2BF;">            } </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">; 否则显示全部</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchResult</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchData</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">;重置列表</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">listView</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Opt</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;-Redraw&quot;</span><span style="color:#ABB2BF;">)    </span><span style="color:#7F848E;font-style:italic;">;禁用重绘</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">listView</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Delete</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;"> in </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchResult</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">listView</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">Add</span><span style="color:#ABB2BF;">(, </span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 调整gui尺寸 并启用重绘</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resizeGui</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#61AFEF;">runHandler</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">that</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">rowNum</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 通过pluginSearchResult和当前启动的行号访问到当前数据</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">curData</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">that</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pluginSearchResult</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">rowNum</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">; 此处的this指的是当前插件，不要和that混淆</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">hideSearchGui</span><span style="color:#ABB2BF;">() </span><span style="color:#7F848E;font-style:italic;">; 隐藏搜索框</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;在文件夹中显示:</span><span style="color:#56B6C2;">\`n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">curData</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">path</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">openFileInFolder</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">curData</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">path</span><span style="color:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;">; 在文件夹中显示当前文件</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">showPluginMode</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">searchData</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">searchHandler</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">runHandler</span><span style="color:#ABB2BF;">, {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">thumb</span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getPluginHIcon</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;">; 搜索框图标</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>效果如图：</p><p><img src="`+A+'" alt="简易文件夹:插件启动项" loading="lazy"></p><p><img src="'+u+'" alt="简易文件夹:插件启动项" loading="lazy"></p><p><img src="'+v+'" alt="简易文件夹:插件启动项" loading="lazy"></p><p><img src="'+E+'" alt="简易文件夹:插件启动项" loading="lazy"></p><p><img src="'+C+'" alt="简易文件夹:插件启动项" loading="lazy"></p>',26);function P(S,w){const p=e("RouterLink"),t=e("ExternalLinkIcon");return c(),r("div",null,[h,n("p",null,[s("参数及说明："),l(p,{to:"/api/showPluginMode.html"},{default:o(()=>[s("PluginHelper.showPluginMode")]),_:1})]),b,n("p",null,[s("当然这个全部内容只是针对"),g,s("，"),l(p,{to:"/dev/plugin-mode/advanced.html"},{default:o(()=>[s("进阶")]),_:1}),s("中有动态获取数据的情况，就不依赖此静态内容。")]),D,n("p",null,[s("指向插件模式的搜索框下方列表，可以通过相关的函数对其进行操作，参考"),n("a",f,[s("ListView (GUI) - 语法 & 使用"),l(t)])]),_])}const H=B(m,[["render",P],["__file","basics.html.vue"]]);export{H as default};
