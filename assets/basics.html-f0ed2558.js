import{_ as l,W as p,X as o,Y as e,Z as s,$ as t,a1 as c,a0 as n,C as B}from"./framework-c8ebc670.js";const r="/Starter/assets/intelligent-1-4f3f86ac.jpg",i="/Starter/assets/intelligent-2-e265fa2e.jpg",y="/Starter/assets/intelligent-3-fafda4ea.jpg",d={},F=n('<p><strong>插件智能项</strong>的功能非常强大，可以通过自定义匹配函数，根据当前输入内容的类型，具体内容，工作窗口等信息判断是否匹配当前插件智能项。</p><p>具体来说，比如，将图片粘贴到智能模式搜索框中，就可以根据输入内容的类型是图片，而匹配到<strong>OCR图片识别</strong>插件添加的智能项。</p><p>比如，将单个文件夹粘贴到搜索框中，就可以根据输入内容的类型是文件，再根据当前文件是文件夹，而匹配到通过<strong>文件搜索</strong>插件添加的智能项。</p><p>而其他方面的操作类似于<strong>插件启动项</strong>，在此不多赘述。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>与<strong>插件启动项</strong>不同，<strong>智能启动项</strong>没有 <code>doubleRightHandler</code> 参数，其他用法类似。</p></div><p>主要内容集中在<strong>自定义匹配</strong>函数</p><h2 id="api" tabindex="-1"><a class="header-anchor" href="#api" aria-hidden="true">#</a> API</h2><p>添加<strong>插件智能项</strong>需要使用 <code>PluginHelper.addPluginToIntelligentMode()</code> API</p>',8),A=n(`<h2 id="简单应用" tabindex="-1"><a class="header-anchor" href="#简单应用" aria-hidden="true">#</a> 简单应用</h2><p>自定义匹配函数的应用，即 <code>matchHandler</code> 参数</p><h3 id="_1-文本匹配" tabindex="-1"><a class="header-anchor" href="#_1-文本匹配" aria-hidden="true">#</a> 1. 文本匹配</h3><p>自由组合文本匹配，matchHandler返回0则不匹配，返回非0则匹配</p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">; 添加插件智能项</span></span>
<span class="line"><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">addIntelligentItem</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 自定义匹配函数</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">matchHandler</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">pastedContentType</span><span style="color:#ABB2BF;">, *) { </span><span style="color:#7F848E;font-style:italic;">; 使用*忽略多余参数</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 带有非文本类型的都不匹配</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">pastedContentType</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">!=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;text&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 若searchText为&quot;PPWB&quot;开头部分</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">strStartWith</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;PPWB&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;1234&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">;或者searchText为1234</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">InStr</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;6&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;">; 或者searchText包含6</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">;则匹配</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">; 其他情况也不匹配</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addPluginToIntelligentMode</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;匹配文本&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">matchHandler</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        (</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, *) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">obj</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    )</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如图，符合<code>InStr(searchText, &quot;6&quot;)</code>而匹配</p><p><img src="`+r+`" alt="文本匹配" loading="lazy"></p><h3 id="_2-输入类型匹配" tabindex="-1"><a class="header-anchor" href="#_2-输入类型匹配" aria-hidden="true">#</a> 2. 输入类型匹配</h3><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">; 添加插件智能项</span></span>
<span class="line"><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">addIntelligentItem</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 自定义匹配函数</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">matchHandler</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">pastedContentType</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">pastedContent</span><span style="color:#ABB2BF;">, *) { </span><span style="color:#7F848E;font-style:italic;">; 使用*忽略多余参数</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">pastedContentType</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;file&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">; 文件类型 且</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">pastedContent</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Length</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">; 文件数量为1 且</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#56B6C2;">InStr</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">FileExist</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">pastedContent</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]), </span><span style="color:#98C379;">&quot;D&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;">; 文件为文件夹</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">; 符合则匹配</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">; 否则不匹配</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addPluginToIntelligentMode</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;匹配单个文件夹&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">matchHandler</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        (</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, *) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">obj</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    )</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如图，符合单个文件夹而匹配</p><p><img src="`+i+`" alt="单文件夹匹配" loading="lazy"></p><h3 id="_3-工作窗口匹配" tabindex="-1"><a class="header-anchor" href="#_3-工作窗口匹配" aria-hidden="true">#</a> 3. 工作窗口匹配</h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>工作窗口模式是按下<strong>智能搜索</strong>快捷键时，若当前<strong>没有选中任何内容</strong>，则<strong>Starter</strong>将获取工作窗口信息，进入工作窗口模式下的智能模式搜索框。</p><p>搜索框会短暂显示工作窗口的信息，插件可以根据此时的工作窗口信息进行匹配</p></div><p>通过工作窗口信息，匹配资源管理器</p><div class="language-ahk line-numbers-mode" data-ext="ahk"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">addIntelligentItem</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">; 自定义匹配函数</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">matchHandler</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">searchText</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">pastedContentType</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">pastedContent</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">workWinInfo</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">winInfoMatchFlag</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 非工作窗口模式不匹配</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 只有工作窗口模式下，窗口信息才是有效的</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 否则可能是上次工作窗口模式的信息</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E06C75;">winInfoMatchFlag</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">pName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">workWinInfo</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">processName</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">cName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">:=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">workWinInfo</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">class</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">; 返回是否满足资源管理器窗口特征 (用或连接)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">pName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;explorer.exe&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">cName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;CabinetWClass&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">cName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;ExploreWClass&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addPluginToIntelligentMode</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;匹配资源管理器&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">matchHandler</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        (</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, *) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PluginHelper</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tip</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">obj</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    )</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+y+'" alt="匹配资源管理器" loading="lazy"></p>',16);function v(u,C){const a=B("RouterLink");return p(),o("div",null,[F,e("p",null,[s("参数及说明："),t(a,{to:"/api/addPluginToIntelligentMode.html"},{default:c(()=>[s("PluginHelper.addPluginToIntelligentMode")]),_:1})]),A])}const E=l(d,[["render",v],["__file","basics.html.vue"]]);export{E as default};
